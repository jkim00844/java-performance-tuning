# story 22

# 웹 로그

아파치나 Nginx, iPlanet과 같은 모든 웹 서버에 공통적으로 제공되는 기능

## 웹 서버의 로그 설정 부분

로그 포맷 설정 : LogFormat “%h %l %u %t \”%r\” %>s %b” common

% 뒤에 표시하고자 하는 데이터의 지시어를 지정

**로그 예시**

127.0.0.1 - - [22/Oct/20XX:14:04:43 +0900] “GET /a.gif HTTP/1.1” 200 2326

1. 127.0.0.1(%h)
    1. 서버에 요청을 한 클라이언트의 IP 주소
    2. 클라이언트가 프록시 서버를 사용할 경우 클라이언트의 실제 주소가 아닌 프록시 서버의 주소가 이 부분에 표시
2. \- (%l)
    1. ‘-’ 로 표시되어 있기 때문에 요청한 정보 없음을 의미
    2. identd 라는 사용자 인식 데몬이 클라이언트에서 동작하고 있을 경우에만 이 정보가 나타남
3. \- (%u)
    1. HTTP 인증을 통하여 확인된 문서를 요청한 사용자의 ID가 표시됨
4. [22/Oct/20XX:14:04:43 +0900] (%t)
    1. 서버가 요청을 마친 시간
    2. 앞에서부터 [날짜/월/년:시:분:초 타임존] 의 순서로 표시
5. “GET /a.gif HTTP/1.1” (\”%r\”)
    1. 클라이언트에서 요청한 Request의 정보를 나타냄
    2. 요청 방식, 요청 주소(URL), 클라이언트에서 사용한 프로토콜 종류와 버전이 표시됨
6. 200 (%>s)
    1. 서버에서 클라이언트로 보낸 최종 상태 코드
7. 2326 (%b)
    1. 클라이언트로 전송한 데이터의 크기 표시

로그 포맷에 %D와 %T를 추가하면 성능 관련 데이터를 얻을 수 있음

- %D : 요청의 처리 시간을 마이크로초 단위로 나타냄
- %T : 요청의 처리 시간을 초 단위로 나타냄

### 로그 무료 분석 툴

- Analog
- A Wstats
- Webalizer

## 웹 통계

### Google 애널리틱스

웹 사용자 통계를 제공하는 무료 툴

웹 로그 기반의 툴은 아니라, 접근하는 모든 페이지에 정보를 전달하는 자바 스크립트 코드를 넣고 구글 서버에 데이터를 쌓는 방식

⇒ 회사 서버에 구글 애널리틱스를 설치하면 회사의 사용량 정보가 유출될 우려가 있음

### Piwik

오픈소스로 제공되는 웹 페이지 접근 통계 툴

**주요 기능**

- 실시간 사용량 정보
- 방문자에 대한 상세한 정보
- 변경 가능한 대시보드
- 내부 검색엔진을 통한 검색 기능
- 방문자의 위치에 대한 세계 지도
- 플러그인 제공
    - 여러 언어에서 사용할 수 있는 API도 제공